(function(a){var b;a.CDNSpeedTest={};CDNSpeedTest.Test=function(d,c){this.url=c;this.key=d;this.result=0;this.ownerList=null;};CDNSpeedTest.Test.prototype={constructor:b.Test,run:function(){var e=this;
var d;var c=new Image();c.addEventListener("load",function(h){var g=(new Date()).getTime();e.result=g-d;var f=document.createEvent("Events");f.initEvent("test.finish",false,false);
f.targetObject=e;document.dispatchEvent(f);},false);c.addEventListener("error",function(g){e.result=-1;var f=document.createEvent("Events");f.initEvent("test.error",false,false);
f.targetObject=e;document.dispatchEvent(f);},false);d=(new Date()).getTime();c.src=this.url+"?t="+d;},reset:function(){this.result=0;}};CDNSpeedTest.TestList=function(){this.list=[];
this.progress=-1;};CDNSpeedTest.TestList.prototype={constructor:b.TestList,result:function(){var c={};for(i=0;i<this.list.length;i++){c[this.list[i].key]=this.list[i].result;
}return c;},handleEvent:function(d){switch(d.type){case"test.error":case"test.finish":this.progress++;if(this.progress<this.list.length){this._step();}else{var c=document.createEvent("Events");
c.initEvent("testlist.finish",false,false);c.targetObject=this;document.dispatchEvent(c);document.removeEventListener("test.finish",this,false);document.removeEventListener("test.error",this,false);
}}},_step:function(){this.list[this.progress].run();},add:function(){var c;for(c=0;c<arguments.length;c++){this.list.push(arguments[c]);arguments[c].ownerList=this;
}},start:function(){if(!this.list.length){return;}this.progress=0;document.addEventListener("test.finish",this,false);document.addEventListener("test.error",this,false);
this._step();},reset:function(){this.progress=-1;for(i=0;i<this.list.length;i++){this.list[i].reset();}}};})(window);