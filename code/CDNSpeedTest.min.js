(function(a){var b;a.CDNSpeedTest={};CDNSpeedTest.Test=function(d,c){this.url=c;this.key=d;this._result=0;this.ownerList=null;};CDNSpeedTest.Test.prototype={constructor:CDNSpeedTest.Test,result:function(){return{key:this.key,url:this.url,time:this._result};
},run:function(){var e=this;var d;var c=new Image();c.addEventListener("load",function(h){var g=(new Date()).getTime();e._result=g-d;var f=document.createEvent("Events");
f.initEvent("test.finish",false,false);f.targetObject=e;document.dispatchEvent(f);},false);c.addEventListener("error",function(g){e._result=-1;var f=document.createEvent("Events");
f.initEvent("test.error",false,false);f.targetObject=e;document.dispatchEvent(f);},false);d=(new Date()).getTime();c.src=this.url+"?t="+d;},reset:function(){this._result=0;
}};CDNSpeedTest.TestList=function(){this.list=[];this.progress=-1;for(i=0;i<arguments.length;i++){this.add(arguments[i]);}};CDNSpeedTest.TestList.prototype={constructor:CDNSpeedTest.TestList,result:function(){var c=[],d;
for(d=0;d<this.list.length;d++){c.push(this.list[d].result());}return c;},handleEvent:function(d){switch(d.type){case"test.error":case"test.finish":this.progress++;
if(this.progress<this.list.length){this._step();}else{var c=document.createEvent("Events");c.initEvent("testlist.finish",false,false);c.targetObject=this;
document.dispatchEvent(c);document.removeEventListener("test.finish",this,false);document.removeEventListener("test.error",this,false);}}},_step:function(){this.list[this.progress].run();
},add:function(){var c;for(c=0;c<arguments.length;c++){this.list.push(arguments[c]);arguments[c].ownerList=this;}},run:function(){if(!this.list.length){return;
}if(this.progress!=-1){return;}this.progress=0;document.addEventListener("test.finish",this,false);document.addEventListener("test.error",this,false);this._step();
},reset:function(){this.progress=-1;for(i=0;i<this.list.length;i++){this.list[i].reset();}}};})(window);